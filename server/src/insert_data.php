<?php require_once 'conn.php'; require_once './statusCode.php'; $statusCode = $_POST['statusCode']; $name = $_POST['name']; $sex = $_POST['sex']; $cclass = $_POST['cclass']; $year = $_POST['year']; $class = $_POST['class']; $phone = $_POST['phone']; $qq = $_POST['qq']; $politicalStatus = $_POST['politicalStatus']; $partOne = $_POST['partOne']; $partTow = $_POST['partTow']; $interviewed = $_POST['interviewed']; $slefIntroduce = $_POST['slefIntroduce']; $status = '未面试'; if (isset($statusCode) && isValidStatusCode($statusCode)) { $sel = $conn->prepare("SELECT * FROM `userdata` WHERE `name` = ? OR `phone` = ? OR `qq` = ?"); $sel->bind_param('sss', $name , $phone , $qq); if ($sel->execute() === TRUE){ $result = $sel->get_result();$numRows = $result->num_rows; if($numRows < 1){ $status = '未面试';$result = '暂未录取';$type='user'; $int = $conn->prepare("INSERT INTO userdata (name,sex,cclass,year,class,phone,qq,politicalStatus,partOne,partTow,interviewed,slefIntroduce,status,result,passwd,type)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"); $int->bind_param('ssssssssssssssss',$name,$sex,$cclass,$year,$class,$phone,$qq,$politicalStatus,$partOne,$partTow,$interviewed,$slefIntroduce,$status,$result,$userPasswd,$type); if($int->execute() === TRUE){ header('Content-Type: application/json'); echo json_encode([ 'errno' => 0, 'message' => '信息录入成功，可通过手机号或qq号登录查看个人信息！默认登录密码：'. $userPasswd.' 登录后请修改自己的登录密码，非明文保存密码，请设置简单好记一点，不要用自己常用密码，作者已经提示到位，怎么设置，自己去捣鼓一下啦！']); }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '系统错误，错误码：3306...请重试或者联系管理员！作者QQ：'.$systemAdminQq ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 0, 'message' => $name.'，你好，与手机号：'.$phone.'或者QQ号：'.$qq.'相关的信息已经存在，如果无法登录，请及时联系负责人处理！' ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '程序错误，错误码：3307。请重试或者联系管理员！作者QQ：'.$systemAdminQq ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '无权访问！！！' ]);} ?>  