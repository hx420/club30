<?php require_once 'conn.php'; require_once './statusCode.php'; $remarks = $_POST['remarks']; $partName = $_POST['partName']; $partIdentity = $_POST['partIdentity']; $userName = $_POST['userName']; $userId = $_POST['userId']; $userPhone = $_POST['userPhone']; $firstPart = $_POST['firstPart']; $secondPart = $_POST['secondPart']; $statusCode = $_POST['statusCode']; if (isset($statusCode) && isValidStatusCode($statusCode)) { $sel = $conn->prepare("SELECT * FROM `remark_data` WHERE (`partName` = ? OR `partIdentity` = ?) AND (`userName` = ? AND `userPhone` = ?)"); $sel->bind_param('ssss', $partName , $partIdentity, $userName , $userPhone); if ($sel->execute() === TRUE){ $result = $sel->get_result();$numRows = $result->num_rows; if($numRows < 1){ $int = $conn->prepare("INSERT INTO remark_data (remarks,partName,partIdentity,userName,userId,userPhone,firstPart,secondPart)VALUES(?,?,?,?,?,?,?,?)"); $int->bind_param('ssssssss',$remarks,$partName,$partIdentity,$userName,$userId,$userPhone,$firstPart,$secondPart); if($int->execute() === TRUE){ header('Content-Type: application/json'); echo json_encode([ 'errno' => 0, 'message' => '备注信息提交成功！！']); }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '系统错误，错误码：3306...请重试或者联系管理员！作者QQ：'.$systemAdminQq ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => $partName.'，你好，备注信息不可重复提交！！' ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '程序错误，错误码：3307。请重试或者联系管理员！作者QQ：'.$systemAdminQq ]);} }else{header('Content-Type: application/json'); echo json_encode([ 'errno' => 1, 'message' => '无权访问！！！' ]);} ?>  
